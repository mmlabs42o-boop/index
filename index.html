<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Stream Overlay - Cyberpunk Edition</title>
    <script src="https://cdn.jsdelivr.net/npm/comfy.js@latest/dist/comfy.min.js"></script>
    <style>
        body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background: transparent; font-family: 'Segoe UI', sans-serif; overflow: hidden; color: white; }
        
        #ai-image { max-width: 90%; max-height: 75vh; border: 8px solid white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transition: opacity 1.5s; opacity: 0; }
        #ai-image.show { opacity: 1; }
        #prompt-display { position: absolute; bottom: 40px; background: rgba(0, 0, 0, 0.8); padding: 15px 25px; border-radius: 50px; font-size: 20px; border: 2px solid #6441a5; transition: opacity 1s; opacity: 0; z-index: 20; }
        #prompt-display.show { opacity: 1; }

        #stats-panel { position: absolute; top: 20px; left: 20px; background: rgba(0, 0, 0, 0.75); padding: 10px 15px; border-radius: 10px; border-left: 4px solid #00f2ff; font-family: monospace; color: #00f2ff; z-index: 50; }
        #status { font-size: 22px; text-shadow: 2px 2px 5px black; background: rgba(0,0,0,0.7); padding: 10px 20px; border-radius: 8px; position: absolute; top: 20px; display: none; z-index: 100; }
        
        /* 6-SLICE WHEEL (Cyberpunk Added) */
        #wheel-container { position: absolute; display: none; flex-direction: column; align-items: center; opacity: 0; transition: opacity 0.5s; z-index: 100; }
        #wheel { 
            width: 300px; height: 300px; border-radius: 50%; border: 8px solid #fff; position: relative; 
            transition: transform 3.5s cubic-bezier(0.15, 0, 0.15, 1); 
            /* 6 Segments at 60 degrees each */
            background: conic-gradient(
                #ff4d4d 0deg 60deg, 
                #00f2ff 60deg 120deg, 
                #4dff88 120deg 180deg, 
                #ffff4d 180deg 240deg, 
                #ff4dff 240deg 300deg, 
                #ffa31a 300deg 360deg
            ); 
        }
        #arrow { width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-top: 30px solid #ffffff; position: absolute; top: -15px; z-index: 110; filter: drop-shadow(0 0 5px black); }
        .label { position: absolute; width: 100%; height: 100%; text-align: center; font-weight: bold; font-size: 11px; padding-top: 30px; transform-origin: 50% 50%; color: black; text-transform: uppercase; }
    </style>
</head>
<body>

    <div id="stats-panel">
        <div>GENS: <span id="count-val">0</span></div>
        <div>ENERGY: <span id="kudos-val">0</span></div>
    </div>

    <div id="status">ðŸ”„ Initializing...</div>
    <div id="prompt-display">Prompt...</div>
    
    <div id="wheel-container">
        <div id="arrow"></div>
        <div id="wheel">
            <div class="label" style="transform: rotate(30deg)">Spooky</div>
            <div class="label" style="transform: rotate(90deg)">Cyberpunk</div>
            <div class="label" style="transform: rotate(150deg)">Absurd</div>
            <div class="label" style="transform: rotate(210deg)">Funny</div>
            <div class="label" style="transform: rotate(270deg)">Abstract</div>
            <div class="label" style="transform: rotate(330deg)">Cartoon</div>
        </div>
    </div>

    <img id="ai-image" src="" />

    <script>
        const channel = "Monstermind42o"; 
        const displayTime = 25000;
        const idleDelay = 15000;
        
        const img = document.getElementById('ai-image');
        const status = document.getElementById('status');
        const promptBanner = document.getElementById('prompt-display');
        const wheelContainer = document.getElementById('wheel-container');
        const wheel = document.getElementById('wheel');
        const countUI = document.getElementById('count-val');
        const kudosUI = document.getElementById('kudos-val');

        let queue = [];
        let isProcessing = false;
        let totalGens = 0;
        let totalKudos = 0;
        let currentRotation = 0;
        let idleTimer;
        // List updated with Cyberpunk
        const categories = ["Spooky", "Cyberpunk", "Absurd", "Funny", "Abstract", "Cartoon"];

        ComfyJS.Init(channel);
        ComfyJS.onCommand = (user, command, message) => {
            if (command === "imagine" && message) {
                queue.push({ user, prompt: message });
                if(!isProcessing) processQueue();
            }
        };

        async function processQueue() {
            if (isProcessing || queue.length === 0) return;